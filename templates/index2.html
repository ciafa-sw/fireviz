<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8' />
<title>Add live realtime data</title>
<meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
<script src='https://api.tiles.mapbox.com/mapbox-gl-js/v1.2.0/mapbox-gl.js'></script>
<link href='https://api.tiles.mapbox.com/mapbox-gl-js/v1.2.0/mapbox-gl.css' rel='stylesheet' />
<style>
  body { margin:0; padding:0; }
  #map { position:absolute; top:0; bottom:0; width:100%; }
</style>
</head>
<body>
  
  <div id='map'></div>
  
  <script>
    mapboxgl.accessToken = '{{ACCESS_KEY}}';
    var map = new mapboxgl.Map({
	container: 'map',
	style: 'mapbox://styles/mapbox/satellite-v9',
	zoom: 2
    });


    var drone_url = 'http://localhost:5000/result';
	var fire_url = 'http://localhost:5000/fire';
    map.on('load', function () {
	
		map.addSource('drone', { type: 'geojson', data: drone_url });
		map.addLayer({
			"id": "drone",
			"type": "symbol",
			"source": "drone",
			"layout": {
			"icon-image": "rocket-15"
			}
		}); // add layer drone

		map.addSource('fire', { type: 'geojson', data: fire_url });
		map.addLayer({
			'id': 'fire',
			'type': 'fill',
			'source': "fire",
			'layout': {},
			'paint': {
				'fill-color': '#088',
				'fill-opacity': 0.8
			}
		}); // add layer fire
		
		
		window.setInterval(function() {
			console.log('got data');
			map.getSource('drone').setData(drone_url);
			map.getSource('fire').setData(fire_url);
		}, 1000);

    }); //map on load



  </script>
  
</body>
</html>
